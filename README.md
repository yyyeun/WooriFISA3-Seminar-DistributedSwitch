# Distributed Switch : 분산 스위치의 구현 및 활용

## 개요
새로운 기술을 배울 때는 핵심 개념을 정확히 이해하는 것이 무엇보다 중요합니다. **분산 스위치**는 가상 네트워크 환경에서 효율적인 머신 간 연결, 중앙 집중식 관리, 네트워크 성능 최적화와 같은 중요한 역할을 합니다. 따라서, 분산 스위치에 대한 깊은 이해는 가상 네트워크 구조 전반을 파악하는 데 필수적이며, 더 나아가 이러한 지식이 효율적인 네트워크 관리로 이어질 수 있습니다.

## 표준 스위치와 분산 스위치

### 표준 스위치 (vSwitch)
**표준 스위치**는 각 ESXi 호스트에 단일로 연결되어 있으며, 가상 머신(VM)을 네트워크에 연결하고 VLAN 내 트래픽을 브리지하는 역할을 합니다. 
- **관리 범위**: 각 ESXi 호스트가 개별적으로 관리됩니다.
- **간편성**: 설정이 간단하며 비용이 저렴합니다.
- **제한점**: 대규모 환경에서는 중앙 집중식 관리가 부족해 복잡해질 수 있습니다.

### 분산 스위치 (vDS)
**분산 스위치**는 **vCenter Server**에 의해 중앙에서 관리되며, 여러 ESXi 호스트에 걸쳐 일관된 네트워크 구성을 제공합니다. 
- **중앙 집중식 관리**: 모든 ESXi 호스트에 대해 일관된 네트워크 구성을 제공합니다.
- **확장성**: 대규모 환경에서 특히 유리합니다.
- **추가 비용**: vCenter와 추가 라이센스 비용이 발생할 수 있습니다.
- **vCenter 의존성**: 설정이 vCenter의 가용성에 따라 달라집니다.

### 표준 스위치와 분산 스위치 비교
두 스위치 모두 VM과 ESXi 호스트 간의 통신을 관리하고 물리적 네트워크와 가상 네트워크를 연결합니다. 하지만 분산 스위치는 **트래픽 모니터링**, **로드 밸런싱**, **대역폭 최적화** 등 표준 스위치보다 고급 기능을 제공합니다.

| 기능                              | 표준 스위치      | 분산 스위치       |
|------------------------------------|-----------------|------------------|
| 중앙 집중식 관리                   | X          | O               |
| 라이센스                | 모든 라이센스 모델         | 엔터프라이즈 에디션 모델             |
| 확장성                            | 제한적           | 높음             |
| VLAN 지원                         | O              | O             |
| 고급 트래픽 관리                   | X        | O              |
| 업링크 및 포트 그룹 관리           | O               | O              |


### 분산 스위치 아키텍처
분산 스위치는 두 가지 주요 구성 요소로 나뉩니다:
1. **제어부(Control Plane)**: vCenter에서 관리되며 네트워크 기능 구성을 정의합니다.
2. **데이터부(Data Plane)**: 각 ESXi 호스트에서 로컬로 실행되며 패킷 스위칭과 필터링을 담당합니다.

**제어부**에서 설정된 네트워크 구성이 **데이터부**로 자동 푸시되며, 이를 통해 모든 호스트에서 네트워크 구성이 동기화됩니다.

#### 업링크 포트 그룹과 분산 포트 그룹
- **업링크 포트 그룹**: 호스트의 물리적 NIC와 매핑됩니다.
- **분산 포트 그룹**: VM과 VMkernel 트래픽을 위한 네트워크 연결을 제공합니다.

#### 트래픽 흐름 
가상 시스템에서 물리적 네트워크로 데이터가 흐르는 방식은 NIC Teaming과 로드 밸런싱 설정에 따라 달라집니다. 분산 스위치는 생성된 순서대로 포트에 ID를 할당하고, 이를 기반으로 데이터 흐름이 결정됩니다.

